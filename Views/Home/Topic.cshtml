@model TopicModel
@{
    TopicDiscussion topic = Model.topic;
}
<main>
    <div>
        <p>@topic.Name by @topic.User?.Login</p>
        <p>@topic.Description</p>
    </div><br/>
    
    @if(topic.Messages.Count != 0)
    {
        @foreach(var message in topic.Messages)
        {
            <div>
                <p>
                    <a asp-action="Profile" asp-route-login="@message.User.Login">@message.User.Login</a> @if (Model.isAdmin)
                    {
                        @Html.ActionLink("Удалить", "DeleteMessage", new { idMessage = message.IdMessage, idTopic = topic.IdTopic }, null);
                    }
                </p>
                <p>@message.TextMessage</p>
            </div>
        }
    }
    else
    {
        <p>В данной теме нет сообщений.</p>
    }

    <div>
        <form asp-action="CreateMessage" asp-controller="home", method="post">
            <input type="hidden" value="0" name="IdMessage" />
            <input type="hidden" value="@false" name="StatusChange" />
            <input type="hidden" value="0" name="Rating" />
            <input type="hidden" value="@Model.user.IdUser" name="UserId" />
            <input type="hidden" value="@topic.IdTopic" name="TopicId" />
            <input type="text" id="TextMessage" name="TextMessage"/>
            <input type="submit" value="Отправить"/>
        </form>
    </div>
</main>
